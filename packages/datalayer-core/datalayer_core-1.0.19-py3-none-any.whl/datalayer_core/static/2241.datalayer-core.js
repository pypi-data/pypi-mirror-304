"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[2241],{82241:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var n=i(30790),o=i(58280);const s="CompletionProvider:context";class r{constructor(){this.identifier=s,this.rank=500,this.renderer=null}async isApplicable(e){return!0}fetch(e,t){const i=t.editor;return i?new Promise((e=>{e(l.contextHint(i))})):Promise.reject("No editor")}}var l;!function(e){e.contextHint=function(e){const t=e.getTokenAtCursor(),i=function(e,t){return t.getTokens().filter((t=>0===t.value.indexOf(e.value)&&t.value!==e.value))}(t,e).filter((e=>e.type)).map((e=>e.value)),n=new Set(i),o=new Array;return n.forEach((e=>o.push({label:e}))),{start:t.offset,end:t.offset+t.value.length,items:o}}}(l||(l={}));var a=i(76437),d=i(18168),c=i(75753);class h{constructor(e){this.options=e,this.identifier="@jupyterlab/inline-completer:history",this._maxSuggestions=100;const t=e.translator||d.Sr;this._trans=t.load("jupyterlab")}get name(){return this._trans.__("History")}get icon(){return c.Dc}get schema(){return{properties:{maxSuggestions:{title:this._trans.__("Maximum number of suggestions"),description:this._trans.__("The maximum number of suggestions to retrieve from history."),type:"number"}},default:{enabled:!1,maxSuggestions:100}}}configure(e){var t;this._maxSuggestions=null!==(t=e.maxSuggestions)&&void 0!==t?t:100}async fetch(e,t,i){var n;const o=null===(n=t.session)||void 0===n?void 0:n.kernel;if(!o)throw new Error("No kernel for completion request.");const s=e.text.slice(0,e.offset).split("\n").slice(-1)[0],r={output:!1,raw:!0,hist_access_type:"search",pattern:s+"*",unique:!0,n:this._maxSuggestions},l=await o.requestHistory(r),a=[];if(""===s)return{items:[]};if("ok"===l.content.status)for(const e of l.content.history){const t=e[2].split("\n");for(let e=0;e<t.length;e++){const i=t[e];if(i.startsWith(s)){const n=i.slice(s.length,i.length)+"\n"+t.slice(e+1).join("\n");a.push({insertText:n})}}}return{items:a}}}var p,m=i(92279),u=i(98209),v=i(59965),g=i(66173),_=i(15487);class f{constructor(e){this.options=e}placeGhost(e,t){const i=[p.addMark.of(t)];e.state.field(p.markField,!1)||(i.push(_.Py.appendConfig.of([p.markField])),i.push(_.Py.appendConfig.of([g.tk.domEventHandlers({blur:t=>{if(!1===this.options.onBlur(t))return!0;const i=[p.removeMark.of(null)];setTimeout((()=>{e.dispatch({effects:i})}),0)}})]))),e.dispatch({effects:i})}clearGhosts(e){const t=[p.removeMark.of(null)];e.dispatch({effects:t})}}f.streamingAnimation="uncover";class w extends g.l9{constructor(e){super(),this.options=e,this.isSpacer=!1}eq(e){return e.content==this.content&&e.options.streaming===this.options.streaming}get lineBreaks(){return(this.content.match(/\n/g)||"").length}updateDOM(e,t){return this._updateDOM(e),!0}get content(){return this.options.content}toDOM(){let e=document.createElement("span");return this.options.onPointerOver&&e.addEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.addEventListener("pointerleave",this.options.onPointerLeave),e.classList.add("jp-GhostText"),e.dataset.animation=f.streamingAnimation,e.dataset.providedBy=this.options.providerId,this._updateDOM(e),e}_updateDOM(e){const t=this.content;let i=this.options.addedPart;if(i&&!this.isSpacer){i.startsWith("\n")&&(i=i.substring(1)),e.innerText=t.substring(0,t.length-i.length);const n=document.createElement("span");n.className="jp-GhostText-streamedToken",n.innerText=i,e.appendChild(n)}else e.innerText=t;if(!this.isSpacer&&this.options.streaming){const t=document.createElement("span");t.className="jp-GhostText-streamingIndicator",e.appendChild(t)}}destroy(e){this.options.onPointerOver&&e.removeEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.removeEventListener("pointerleave",this.options.onPointerLeave),super.destroy(e)}}class y extends w{constructor(){super(...arguments),this.isSpacer=!0}}class C extends y{toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-lineSpacer"),e}}class P extends y{get content(){return this.options.content[0]}toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-letterSpacer"),e}}!function(e){let t;function i(e,t){return g.p.widget({widget:new w(e),side:1,ghostSpec:e}).range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))}!function(e){e[e.Set=0]="Set",e[e.Remove=1]="Remove",e[e.FilterAndUpdate=2]="FilterAndUpdate"}(t||(t={})),e.addMark=_.Py.define({map:(e,t)=>({...e,from:t.mapPos(e.from),to:t.mapPos(e.from+e.content.length)})}),e.removeMark=_.Py.define(),e.markField=_.QQ.define({create:()=>g.p.none,update(n,o){const s=function(i){for(let n of i.effects){if(n.is(e.addMark))return{action:t.Set,spec:n.value};if(n.is(e.removeMark))return{action:t.Remove}}return i.docChanged||i.selection?{action:t.FilterAndUpdate}:null}(o);if(n=n.update({filter:(e,t,i)=>!(i.spec.widget instanceof y&&i.spec.timeoutInfo.elapsed)}),!s)return n.map(o.changes);switch(s.action){case t.Set:{const e=i(s.spec,o);return n.update({add:[e],filter:(t,i,n)=>n===e.value})}case t.Remove:return n.update({filter:()=>!1});case t.FilterAndUpdate:{let e=n.iter();for(;e.value&&e.value.spec.widget instanceof y;)e.next();if(!e.value)return n.map(o.changes);const t=e.value.spec.ghostSpec,s={...t};let r=!1;o.changes.iterChanges(((e,t,i,n,o)=>{if(!r)if(e===t&&i!==n)for(let e=0;e<o.lines;e++){const t=o.lineAt(e).text,i=e>0?"\n"+t:t;if(!s.content.startsWith(i)){r=!0;break}s.content=s.content.slice(i.length),s.from+=i.length}else r=!0}));const l=r?function(e,t,i=1e3){if(e.content.length<2)return[];const n={elapsed:!1};setTimeout((()=>{n.elapsed=!0}),i);const o=g.p.widget({widget:new P(e),side:1,timeoutInfo:n}),s=g.p.widget({widget:new C(e),side:1,timeoutInfo:n});return[o.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length)),s.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))]}(t,o):[i(s,o)],a=l.map((e=>e.value));if(n=n.update({add:l,filter:(e,t,i)=>a.includes(i)}),r)try{n=n.map(o.changes)}catch(e){return console.warn(e),g.p.none}return n}}},provide:e=>g.tk.decorations.from(e)})}(p||(p={}));const x="jp-mod-inline-completer-active",b="jp-InlineCompleter-hover";class S extends m.$L{constructor(e){var t,i;super({node:document.createElement("div")}),this._clearHoverTimeout=null,this._current=0,this._editor=null,this._lastItem=null,this._model=null,this._providerWidget=new m.$L,this._showShortcuts=S.defaultSettings.showShortcuts,this._showWidget=S.defaultSettings.showWidget,this._suggestionsCounter=new m.$L,this._toolbar=new n.o8,this.model=null!==(t=e.model)&&void 0!==t?t:null,this.editor=null!==(i=e.editor)&&void 0!==i?i:null,this.addClass("jp-InlineCompleter"),this._ghostManager=new f({onBlur:this._onEditorBlur.bind(this)}),this._trans=e.trans;const o=this.layout=new m.LN;o.addWidget(this._suggestionsCounter),o.addWidget(this.toolbar),o.addWidget(this._providerWidget),this._progressBar=document.createElement("div"),this._progressBar.className="jp-InlineCompleter-progressBar",this.node.appendChild(this._progressBar),this._updateShortcutsVisibility(),this._updateDisplay(),this.node.tabIndex=0}get toolbar(){return this._toolbar}get editor(){return this._editor}set editor(e){var t;null===(t=this.model)||void 0===t||t.reset(),this._editor=e}get model(){return this._model}set model(e){(e||this._model)&&e!==this._model&&(this._model&&(this._model.suggestionsChanged.disconnect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.disconnect(this._onModelFilterTextChanged,this),this._model.provisionProgress.disconnect(this._onProvisionProgress,this)),this._model=e,this._model&&(this._model.suggestionsChanged.connect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.connect(this._onModelFilterTextChanged,this),this._model.provisionProgress.connect(this._onProvisionProgress,this)))}cycle(e){var t,i;const n=null===(i=null===(t=this.model)||void 0===t?void 0:t.completions)||void 0===i?void 0:i.items;if(n){if("next"===e){const e=this._current+1;this._current=e===n.length?0:e}else{const e=this._current-1;this._current=-1===e?n.length-1:e}this._updateStreamTracking(),this._render()}}accept(){const e=this.model,t=this.current,i=this._editor;if(!i||!e||!t)return;const n=e.cursor,o=t.insertText,s=i.getOffsetAt(i.getCursorPosition()),r=i.getOffsetAt(n),l=r,a=s;i.model.sharedModel.updateSource(r,s,o),s<=a&&s>=l&&i.setCursorPosition(i.getPositionAt(l+o.length)),e.reset(),this.update()}get current(){var e;const t=null===(e=this.model)||void 0===e?void 0:e.completions;return t?t.items[this._current]:null}_updateStreamTracking(){this._lastItem&&this._lastItem.stream.disconnect(this._onStream,this);const e=this.current;e&&e.stream.connect(this._onStream,this),this._lastItem=e}_onStream(e,t){var i;const n=null===(i=this.model)||void 0===i?void 0:i.completions;if(!n||!n.items||0===n.items.length)return;if(this.isHidden)return;const o=n.items[this._current];this._setText(o)}configure(e){this._showWidget=e.showWidget,this._updateDisplay(),e.showShortcuts!==this._showShortcuts&&(this._showShortcuts=e.showShortcuts,this._updateShortcutsVisibility()),f.streamingAnimation=e.streamingAnimation}handleEvent(e){if(!this.isHidden&&this._editor)switch(e.type){case"pointerdown":this._evtPointerdown(e);break;case"scroll":this._evtScroll(e)}}onUpdateRequest(e){super.onUpdateRequest(e);const t=this._model;if(!t)return;let i=t.completions;i&&i.items&&0!==i.items.length?this.isHidden&&(this.show(),this._setGeometry()):this.isHidden||this.hide()}onAfterAttach(e){document.addEventListener("scroll",this,!0),document.addEventListener("pointerdown",this,!0)}onBeforeDetach(e){document.removeEventListener("scroll",this,!0),document.removeEventListener("pointerdown",this,!0)}_evtPointerdown(e){var t;if(this.isHidden||!this._editor)return;const i=e.target;if(this.node.contains(i))return!0;this.hide(),null===(t=this.model)||void 0===t||t.reset()}_evtScroll(e){if(this.isHidden||!this._editor)return;const{node:t}=this;t.contains(e.target)||requestAnimationFrame((()=>{this._setGeometry()}))}_onEditorBlur(e){var t;if(this.node.contains(e.relatedTarget))return!1;null===(t=this._editor)||void 0===t||t.host.classList.remove(x),this.hide()}_onModelSuggestionsChanged(e,t){var i;if(this.isAttached){if("set"===t.event)this._current=null!==(i=t.indexMap.get(this._current))&&void 0!==i?i:0;else if("clear"===t.event){const e=this.editor;e&&(this._ghostManager.clearGhosts(e.editor),e.host.classList.remove(x))}this._updateStreamTracking(),this.update(),this._render()}else this.update()}_onModelFilterTextChanged(e,t){var i,n;const o=null===(i=this.model)||void 0===i?void 0:i.completions;o&&o.items&&0!==o.items.length&&(this._current=null!==(n=t.get(this._current))&&void 0!==n?n:0,this._updateStreamTracking(),setTimeout((()=>{this._render(),this._setGeometry()}),0))}_onProvisionProgress(e,t){requestAnimationFrame((()=>{0===t.pendingProviders?this._progressBar.style.display="none":(this._progressBar.style.display="",this._progressBar.style.width=100*t.pendingProviders/t.totalProviders+"%")}))}_render(){var e,t;const i=null===(e=this.model)||void 0===e?void 0:e.completions;if(!i||!i.items||0===i.items.length)return;const n=i.items[this._current];this._setText(n),"never"!==this._showWidget&&(this._suggestionsCounter.node.innerText=this._trans.__("%1/%2",this._current+1,i.items.length),this._providerWidget.node.title=this._trans.__("Provider: %1",n.provider.name),(null!==(t=n.provider.icon)&&void 0!==t?t:c.Ec).render(this._providerWidget.node))}_setText(e){const t=e.insertText,i=this._editor,n=this._model;if(!n||!i)return;const o=i.editor;this._ghostManager.placeGhost(o,{from:i.getOffsetAt(n.cursor),content:t,providerId:e.provider.identifier,addedPart:e.lastStreamed,streaming:e.streaming,onPointerOver:this._onPointerOverGhost.bind(this),onPointerLeave:this._onPointerLeaveGhost.bind(this)}),i.host.classList.add(x)}_onPointerOverGhost(){null!==this._clearHoverTimeout&&(window.clearTimeout(this._clearHoverTimeout),this._clearHoverTimeout=null),this.node.classList.add(b)}_onPointerLeaveGhost(){this._clearHoverTimeout=window.setTimeout((()=>this.node.classList.remove(b)),500)}_setGeometry(){const{node:e}=this,t=this._model,i=this._editor;if(!i||!t||!t.cursor)return;const n=i.host.closest(".jp-MainAreaWidget > .lm-Widget")||i.host;let o;try{o=i.getCoordinateForPosition(t.cursor)}catch(e){return void this.hide()}v.Y.setGeometry({anchor:o,host:n,maxHeight:40,minHeight:20,node:e,privilege:"forceAbove",outOfViewDisplay:{top:"stick-outside",bottom:"stick-inside",left:"stick-inside",right:"stick-outside"}})}_updateShortcutsVisibility(){this.node.dataset.showShortcuts=this._showShortcuts+""}_updateDisplay(){this.node.dataset.display=this._showWidget}}!function(e){e.defaultSettings={showWidget:"onHover",showShortcuts:!0,streamingAnimation:"uncover",providers:{}},e.Model=class{constructor(){this.suggestionsChanged=new u.Signal(this),this.filterTextChanged=new u.Signal(this),this.provisionProgress=new u.Signal(this),this._isDisposed=!1,this._completions=null}setCompletions(e){var t,i;const n=new Map(null===(i=null===(t=this._completions)||void 0===t?void 0:t.items)||void 0===i?void 0:i.map(((e,t)=>[e.insertText,t])));this._completions=e;const o=new Map(e.items.map(((e,t)=>[n.get(e.insertText),t])));this.suggestionsChanged.emit({event:"set",indexMap:o})}appendCompletions(e){this._completions&&this._completions.items?(this._completions.items.push(...e.items),this.suggestionsChanged.emit({event:"append"})):console.warn("No completions to append to")}notifyProgress(e){this.provisionProgress.emit(e)}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get completions(){return this._completions}reset(){this._completions=null,this.suggestionsChanged.emit({event:"clear"})}get isDisposed(){return this._isDisposed}handleTextChange(e){var t;const i=this._completions;if(!i||!i.items||0===i.items.length)return;const n=new Map(i.items.map(((e,t)=>[e,t])));for(let n of null!==(t=e.sourceChange)&&void 0!==t?t:[]){const e=n.insert;if(e){const t=i.items.filter((t=>{var i;const n=null!==(i=t.filterText)&&void 0!==i?i:t.insertText;return!!n.startsWith(e)&&(t.filterText=n.substring(e.length),t.insertText=t.insertText.substring(e.length),!0)}));0===t.length&&(this._completions=null),i.items=t}else n.retain||(this._completions=null)}const o=new Map(i.items.map(((e,t)=>[n.get(e),t])));this.filterTextChanged.emit(o)}handleSelectionChange(e){const t=this.cursor;if(!t)return;const{start:i,end:n}=e;i.column===n.column&&i.line===n.line||this.reset(),(i.line!==t.line||i.column<t.column)&&this.reset()}dispose(){this._isDisposed||(this._isDisposed=!0,u.Signal.clearData(this))}}}(S||(S={}));var k=i(88553),I=i(8505),T=i(38900),M=i(92627);class E{constructor(){this._activeProviders=new Set([a.R,s]),this._inlineCompleterSettings=S.defaultSettings,this._providers=new Map,this._inlineProviders=new Map,this._panelHandlers=new Map,this._mostRecentContext=new Map,this._activeProvidersChanged=new u.Signal(this),this._inlineCompleterFactory=null}get activeProvidersChanged(){return this._activeProvidersChanged}setTimeout(e){this._timeout=e}setShowDocumentationPanel(e){this._panelHandlers.forEach((t=>t.completer.showDocsPanel=e)),this._showDoc=e}setContinuousHinting(e){this._panelHandlers.forEach((t=>t.autoCompletion=e)),this._autoCompletion=e}registerProvider(e){const t=e.identifier;this._providers.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._providers.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}registerInlineProvider(e){const t=e.identifier;this._inlineProviders.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._inlineProviders.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}getProviders(){return this._providers}activateProvider(e){this._activeProviders=new Set([]),e.forEach((e=>{this._providers.has(e)&&this._activeProviders.add(e)})),0===this._activeProviders.size&&(this._activeProviders.add(a.R),this._activeProviders.add(s)),this._activeProvidersChanged.emit()}async updateCompleter(e){var t,i;const{widget:n,editor:o,sanitizer:s}=e,r=n.id,l=this._panelHandlers.get(r),a=[...this._activeProviders][0],d=this._providers.get(a);let c=null!==(t=null==d?void 0:d.renderer)&&void 0!==t?t:M.X.getDefaultRenderer(s);const h=null==d?void 0:d.modelFactory;let p;p=h?await h.call(d,e):new T.B,this._mostRecentContext.set(n.id,e);const m={model:p,editor:o,renderer:c,sanitizer:s,showDoc:this._showDoc};if(l){const t=l.completer;null===(i=t.model)||void 0===i||i.dispose(),t.model=m.model,t.renderer=m.renderer,t.showDocsPanel=m.showDoc,l.autoCompletion=this._autoCompletion,o&&(l.editor=o,l.reconciliator=await this.generateReconciliator(e))}else{const t=await this._generateHandler(e,m);this._panelHandlers.set(n.id,t),n.disposed.connect((e=>{this.disposeHandler(e.id,t),this._mostRecentContext.delete(r)}))}}invoke(e){const t=this._panelHandlers.get(e);t&&t.invoke()}select(e){const t=this._panelHandlers.get(e);t&&t.completer.selectActive()}setInlineCompleterFactory(e){this._inlineCompleterFactory=e,this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})),this.inline||(this.inline={invoke:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.invokeInline()},cycle:(e,t)=>{const i=this._panelHandlers.get(e);i&&i.inlineCompleter&&i.inlineCompleter.cycle(t)},accept:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.inlineCompleter.accept()},configure:e=>{this._inlineCompleterSettings=e,this._panelHandlers.forEach(((t,i)=>{for(const[t,i]of this._inlineProviders.entries())i.configure&&i.configure(e.providers[t]);t.inlineCompleter&&t.inlineCompleter.configure(e),this.updateCompleter(this._mostRecentContext.get(i))}))}})}get inlineProviders(){return[...this._inlineProviders.values()]}async generateReconciliator(e){const t=[];for(const[e,i]of Object.entries(this._inlineCompleterSettings.providers))!0===i.enabled&&t.push(e);const i=[...this._inlineProviders.values()].filter((e=>t.includes(e.identifier))),n=[];for(const e of this._activeProviders){const t=this._providers.get(e);t&&n.push(t)}return new k.K({context:e,providers:n,inlineProviders:i,inlineProvidersSettings:this._inlineCompleterSettings.providers,timeout:this._timeout})}disposeHandler(e,t){var i,n,o,s;null===(i=t.completer.model)||void 0===i||i.dispose(),t.completer.dispose(),null===(o=null===(n=t.inlineCompleter)||void 0===n?void 0:n.model)||void 0===o||o.dispose(),null===(s=t.inlineCompleter)||void 0===s||s.dispose(),t.dispose(),this._panelHandlers.delete(e)}async _generateHandler(e,t){const i=new M.X(t),n=this._inlineCompleterFactory?this._inlineCompleterFactory.factory({...t,model:new S.Model}):void 0;i.hide(),m.$L.attach(i,document.body),n&&(m.$L.attach(n,document.body),n.hide(),n.configure(this._inlineCompleterSettings));const o=await this.generateReconciliator(e),s=new I._({completer:i,inlineCompleter:n,reconciliator:o});return s.editor=e.editor,s}}var D=i(35909),H=i(56276),A=i(63070),L=i(56769);const O="availableProviders";function j(e){const{schema:t}=e,i=t.title,n=t.description,o=e.formContext.settings,s=o.get(O).user,r={...t.default};if(s)for(const e of Object.keys(r))r[e]=e in s?s[e]:-1;const[l,a]=(0,L.useState)(r);return L.createElement("div",null,L.createElement("fieldset",null,L.createElement("legend",null,i),L.createElement("p",{className:"field-description"},n),Object.keys(r).map((e=>L.createElement("div",{key:e,className:"form-group small-field"},L.createElement("div",null,L.createElement("h3",null," ",e),L.createElement("div",{className:"inputFieldWrapper"},L.createElement("input",{className:"form-control",type:"number",value:l[e],onChange:t=>{((e,t)=>{const i={...l,[e]:parseInt(t.target.value)};o.set(O,i).catch(console.error),a(i)})(e,t)}}))))))))}const R="@jupyterlab/completer-extension:manager",W="@jupyterlab/completer-extension:inline-completer";var F;!function(e){e.nextInline="inline-completer:next",e.previousInline="inline-completer:previous",e.acceptInline="inline-completer:accept",e.invokeInline="inline-completer:invoke"}(F||(F={}));const B={id:"@jupyterlab/completer-extension:base-service",description:"Adds context and kernel completion providers.",requires:[o.pl],autoStart:!0,activate:(e,t)=>{t.registerProvider(new r),t.registerProvider(new a.D)}},G={id:"@jupyterlab/completer-extension:inline-history",description:"Adds inline completion provider suggesting code from execution history.",requires:[o.pl],optional:[d.gv],autoStart:!0,activate:(e,t,i)=>{t.registerInlineProvider(new h({translator:null!=i?i:d.Sr}))}},q={id:"@jupyterlab/completer-extension:inline-completer-factory",description:"Provides a factory for inline completer.",provides:o.zp,optional:[d.gv],autoStart:!0,activate:(e,t)=>{const i=(t||d.Sr).load("jupyterlab");return{factory:t=>{const o=new S({...t,trans:i}),s=t=>{const i=e.commands.keyBindings.find((e=>e.command===t)),n=i?A.H.formatKeystroke(i.keys):"";return n?`${n}`:""},r={[F.previousInline]:s(F.previousInline),[F.nextInline]:s(F.nextInline),[F.acceptInline]:s(F.acceptInline)};return e.commands.keyBindingChanged.connect(((e,t)=>{const i=t.binding.command;r.hasOwnProperty(i)&&(r[i]=s(i))})),o.toolbar.addItem("previous-inline-completion",new n.oR({commands:e.commands,icon:c.Co,id:F.previousInline,label:()=>r[F.previousInline],caption:i.__("Previous")})),o.toolbar.addItem("next-inline-completion",new n.oR({commands:e.commands,icon:c.dz,id:F.nextInline,label:()=>r[F.nextInline],caption:i.__("Next")})),o.toolbar.addItem("accept-inline-completion",new n.oR({commands:e.commands,icon:c.eQ,id:F.acceptInline,label:()=>r[F.acceptInline],caption:i.__("Accept")})),o}}}},N={id:W,description:"Registers the inline completer factory; adds inline completer commands, shortcuts and settings.",requires:[o.pl,o.zp,D.O],optional:[d.gv],autoStart:!0,activate:(e,t,i,n,o)=>{t.setInlineCompleterFactory(i);const s=(o||d.Sr).load("jupyterlab"),r=()=>!!e.shell.currentWidget&&!!t.inline;e.commands.addCommand(F.nextInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"next")},label:s.__("Next Inline Completion"),isEnabled:r}),e.commands.addCommand(F.previousInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"previous")},label:s.__("Previous Inline Completion"),isEnabled:r}),e.commands.addCommand(F.acceptInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.accept(e.shell.currentWidget.id)},label:s.__("Accept Inline Completion"),isEnabled:r}),e.commands.addCommand(F.invokeInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.invoke(e.shell.currentWidget.id)},label:s.__("Invoke Inline Completer"),isEnabled:r});const l=e=>{var i;null===(i=t.inline)||void 0===i||i.configure(e.composite)};e.restored.then((()=>{var e;const i=null!==(e=t.inlineProviders)&&void 0!==e?e:[],o=e=>{var t,i;return{enabled:!0,timeout:5e3,debouncerDelay:0,...null!==(i=null===(t=e.schema)||void 0===t?void 0:t.default)&&void 0!==i?i:{}}};n.transform(W,{compose:e=>{var t,n;const s=null!==(t=e.data.composite.providers)&&void 0!==t?t:{};for(const e of i){const t=o(e);s[e.identifier]={...t,...null!==(n=s[e.identifier])&&void 0!==n?n:{}}}return e.data.composite.providers=s,e},fetch:e=>{var t,n;const r=e.schema.properties,l={};for(const e of i)l[e.identifier]={title:s.__("%1 provider",e.name),properties:{...null!==(n=null===(t=e.schema)||void 0===t?void 0:t.properties)&&void 0!==n?n:{},timeout:{title:s.__("Timeout"),description:s.__("Timeout for %1 provider (in milliseconds).",e.name),type:"number",minimum:0},debouncerDelay:{title:s.__("Debouncer delay"),minimum:0,description:s.__("Time since the last key press to wait before requesting completions from %1 provider (in milliseconds).",e.name),type:"number"},enabled:{title:s.__("Enabled"),description:s.__("Whether to fetch completions %1 provider.",e.name),type:"boolean"}},default:o(e),type:"object"};return r.providers.properties=l,e}}),n.load(W).then((e=>{l(e),e.changed.connect((e=>{l(e)}))})).catch(console.error)})).catch(console.error);const a=t=>e.commands.keyBindings.find((e=>e.command===t)),c={[F.acceptInline]:a(F.acceptInline),[F.invokeInline]:a(F.invokeInline)};e.commands.keyBindingChanged.connect(((e,t)=>{const i=t.binding.command;c.hasOwnProperty(i)&&(c[i]=a(i))})),document.addEventListener("keydown",(t=>{if(!(t.target instanceof Element))return;const i=t.target;switch(t.keyCode){case 9:{const n=[c[F.acceptInline],c[F.invokeInline]];for(const o of n)if(o&&1===o.keys.length&&"Tab"===o.keys[0]&&i.closest(o.selector))return e.commands.execute(o.command).catch(console.error),t.preventDefault(),t.stopPropagation(),void t.stopImmediatePropagation();break}default:return}}),!0)}},$={id:R,description:"Provides the completion provider manager.",requires:[D.O],optional:[H.C],provides:o.pl,autoStart:!0,activate:(e,t,i)=>{const n="availableProviders",o=new E,s=(e,t)=>{var i;const s=e.get(n),r=e.get("providerTimeout"),l=e.get("showDocumentationPanel"),a=e.get("autoCompletion");o.setTimeout(r.composite),o.setShowDocumentationPanel(l.composite),o.setContinuousHinting(a.composite);const d=null!==(i=s.user)&&void 0!==i?i:s.composite,c=Object.entries(null!=d?d:{}).filter((e=>e[1]>=0&&t.includes(e[0]))).sort((([,e],[,t])=>t-e)).map((e=>e[0]));o.activateProvider(c)};if(e.restored.then((()=>{const e=[...o.getProviders().entries()],i=e.map((([e,t])=>e));t.transform(R,{fetch:t=>{const i=t.schema.properties,o={};return e.forEach((([e,t],i)=>{var n;o[e]=null!==(n=t.rank)&&void 0!==n?n:10*(i+1)})),i[n].default=o,t}}),t.load(R).then((e=>{s(e,i),e.changed.connect((e=>{s(e,i)}))})).catch(console.error)})).catch(console.error),i){const e={fieldRenderer:e=>j(e)};i.addRenderer(`${R}.availableProviders`,e)}return o}},z=[$,B,G,q,N]},56276:(e,t,i)=>{i.d(t,{C:()=>o,E:()=>s});var n=i(47963);const o=new n.Token("@jupyterlab/ui-components:IFormRendererRegistry","A service for settings form renderer registration."),s=new n.Token("@jupyterlab/ui-components:ILabIconManager","A service to register and request icons.")}}]);