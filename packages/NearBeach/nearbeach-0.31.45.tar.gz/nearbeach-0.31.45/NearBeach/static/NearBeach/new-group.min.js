"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[4773],{4951:(e,a,r)=>{r.r(a),r.d(a,{default:()=>f});var o=r(641),t=r(3751);const s={class:"card"},l={class:"card-body"},u={class:"row"},n={class:"col-md-8"},i={class:"form-group"},d={key:0,class:"error"},p={key:1,class:"error"},c={class:"form-group"},h={class:"row submit-row"},m={class:"col-md-12"};var g=r(1080),k=r(9639),v=r(3855),N=r(404),w=r(9827);const G={name:"NewGroup",setup:()=>({v$:(0,k.Ay)()}),components:{NSelect:g.A,ValidationRendering:N.A},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""}},data:()=>({checkingGroupName:!1,groupNameModel:"",groupResultsFixList:[],parentGroupModel:"",searchTimeout:"",uniqueGroupName:!0}),mixins:[w.A],validations:{groupNameModel:{required:v.mw}},watch:{groupNameModel(e){this.checkingGroupName=!0,""!==this.searchTimeout&&clearTimeout(this.searchTimeout),e.length>=3&&(this.searchTimeout=setTimeout((()=>{this.checkGroupName()}),500))}},methods:{addNewGroup(){if(this.v$.$touch(),this.v$.$invalid||!this.uniqueGroupName)return void this.$store.dispatch("newToast",{header:"Please check all fields",message:"Failed validation. Please check all fields are validated",extra_classes:"bg-danger",delay:0,unique_type:"update_user"});const e=new FormData;e.set("group_name",this.groupNameModel),void 0!==this.parentGroupModel&&e.set("parent_group",this.parentGroupModel),this.axios.post(`${this.rootUrl}new_group/save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to Add New Group",message:`Sorry, could not save new group. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},checkGroupName(){const e=new FormData;e.set("search",this.groupNameModel),this.axios.post(`${this.rootUrl}group_information/check_group_name/`,e).then((e=>{this.uniqueGroupName=0===e.data.length,this.checkingGroupName=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to Check the Group Name",message:`Sorry, could not check the group name. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.groupResultsFixList=this.groupResults.map((e=>({label:e.fields.group_name,value:e.pk})))}},f=(0,r(6262).A)(G,[["render",function(e,a,r,g,k,v){const N=(0,o.g2)("validation-rendering"),w=(0,o.g2)("n-select"),G=(0,o.g2)("n-config-provider");return(0,o.uX)(),(0,o.Wv)(G,{theme:e.getTheme(r.theme)},{default:(0,o.k6)((()=>[(0,o.Lk)("div",s,[(0,o.Lk)("div",l,[a[6]||(a[6]=(0,o.Lk)("h1",null,"New Group",-1)),a[7]||(a[7]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("div",u,[a[5]||(a[5]=(0,o.Lk)("div",{class:"col-md-4"},[(0,o.Lk)("strong",null,"Create a new group"),(0,o.Lk)("p",{class:"text-instructional"}," Each group should contain a unique name. If the name already exists then we won't be able to create the group. ")],-1)),(0,o.Lk)("div",n,[(0,o.Lk)("div",i,[(0,o.Lk)("label",null,[a[3]||(a[3]=(0,o.eW)(" Group Name ")),(0,o.bF)(N,{"error-list":g.v$.groupNameModel.$errors},null,8,["error-list"]),k.uniqueGroupName?(0,o.Q3)("v-if",!0):((0,o.uX)(),(0,o.CE)("span",d," Please supply a unique name")),k.checkingGroupName?((0,o.uX)(),(0,o.CE)("span",p," Checking group name...")):(0,o.Q3)("v-if",!0)]),(0,o.bo)((0,o.Lk)("input",{class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>k.groupNameModel=e)},null,512),[[t.vModelText,k.groupNameModel]])]),(0,o.Lk)("div",c,[a[4]||(a[4]=(0,o.Lk)("label",null," Parent Group (optional) ",-1)),(0,o.bF)(w,{options:k.groupResultsFixList,value:k.parentGroupModel,"onUpdate:value":a[1]||(a[1]=e=>k.parentGroupModel=e),label:"group_name"},null,8,["options","value"])])])]),(0,o.Q3)(" Submit Button "),a[8]||(a[8]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("div",h,[(0,o.Lk)("div",m,[(0,o.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:a[2]||(a[2]=(...e)=>v.addNewGroup&&v.addNewGroup(...e))},"Create new Group")])])])])])),_:1},8,["theme"])}]])},404:(e,a,r)=>{r.d(a,{A:()=>l});var o=r(641),t=r(33);const s={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},l=(0,r(6262).A)(s,[["render",function(e,a,r,s,l,u){return(0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.errorList,(e=>((0,o.uX)(),(0,o.CE)("span",{class:"error",key:e.$uid},(0,t.toDisplayString)(e.$message),1)))),128)}]])},9827:(e,a,r)=>{r.d(a,{A:()=>t});var o=r(7413);const t={data:()=>({darkTheme:o.a}),methods:{getTheme:e=>"dark"===e?o.a:null}}}}]);