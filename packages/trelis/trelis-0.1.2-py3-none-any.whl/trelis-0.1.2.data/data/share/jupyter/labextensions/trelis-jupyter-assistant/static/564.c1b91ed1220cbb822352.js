"use strict";(self.webpackChunktrelis_jupyter_assistant=self.webpackChunktrelis_jupyter_assistant||[]).push([[564],{564:(e,n,t)=>{t.r(n),t.d(n,{default:()=>A});var a=t(909),r=t(614),o=t(480),i=t(215),s=t(256);class c extends s.Widget{constructor(e,n){super(),this.notebookTracker=e,this.addClass("jp-ChatbotWidget"),this.chatContainer=document.createElement("div"),this.inputArea=document.createElement("textarea"),this.rendermime=n,this.initializeWidget()}initializeWidget(){this.node.style.display="flex",this.node.style.flexDirection="column",this.node.style.height="100%";const e=document.createElement("div");e.className="chat-interface",this.chatContainer.className="chat-container";const n=document.createElement("div");n.className="input-container",this.inputArea.rows=3,this.inputArea.className="input-area",this.inputArea.style.width="100%",this.inputArea.addEventListener("keydown",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.handleSend())}));const t=document.createElement("div");t.className="send-button-container";const a=document.createElement("button");a.textContent="Send",a.className="send-button",a.onclick=()=>this.handleSend();const r=document.createElement("span");r.className="send-button-hint",r.textContent="(or press Enter)",t.appendChild(a),t.appendChild(r),n.appendChild(this.inputArea),n.appendChild(t),e.appendChild(this.chatContainer),e.appendChild(n),this.node.appendChild(e)}handleSend(){const e=this.inputArea.value.trim();e&&(this.addMessage("user",e),this.inputArea.value="",this.mockAssistantResponse(e))}async addMessage(e,n){const t=document.createElement("div");t.className=`chat-message ${e}-message`;const a=document.createElement("strong");if(a.textContent="user"===e?"You: ":"Trelis Assistant: ",t.appendChild(a),"assistant"===e){const e=await this.renderAssistantMessage(n);t.appendChild(e)}else{const e=await this.renderMarkdown(n);t.appendChild(e)}this.chatContainer.appendChild(t),this.chatContainer.scrollTop=this.chatContainer.scrollHeight}async renderAssistantMessage(e){const n=document.createElement("div"),t=this.parseCodeSuggestions(e),a=e.split("\n");for(let e=0;e<a.length;e++){const r=a[e];if(r.startsWith("```python")){const r=[];let o=e+1;for(;o<a.length&&!a[o].startsWith("```");)r.push(a[o]),o++;const i=r.join("\n"),s=t.find((([e,n])=>n.trim()===i.trim())),c=document.createElement("div");c.className="code-container";const d=await this.renderMarkdown("```python\n"+i+"\n```");if(c.appendChild(d),s){const[e,n]=s,t=this.createReplaceButton(e,i);c.appendChild(t)}n.appendChild(c),e=o}else{const e=await this.renderMarkdown(r);n.appendChild(e)}}return n}createReplaceButton(e,n){const t=document.createElement("button");return t.textContent=`Replace cell ${e}`,t.className="replace-button",t.onclick=()=>this.replaceCode(e,n),t}async renderMarkdown(e){const n="text/markdown",t=new i.MimeModel({data:{[n]:e},metadata:{}}),a=this.rendermime.createRenderer(n);return await a.renderModel(t),a.node}mockAssistantResponse(e){setTimeout((()=>{this.addMessage("assistant","I've analyzed the code in your notebook. Here's a suggestion:\n\nIn cell [2], you might want to update the code to:\n\n```python\nimport pandas as pd\nimport numpy as np\n\ndata = pd.read_csv('data.csv')\nresult = np.mean(data['column'])\nprint(f\"The mean is: {result}\")\n```\n\nand then in cell [3], you might want to update the code to:\n\n```python\nimport matplotlib.pyplot as plt\n\nplt.plot(data['column'], data['column'])\nplt.show()\n```\n\nThis change will improve the data processing efficiency.")}),1e3)}parseCodeSuggestions(e){const n=/```python\n([\s\S]*?)```/g,t=/(?:in|In) cell (?:\[?(\d+)\]?|(\w+))|Cell (\d+):/i,a=[];let r;for(;null!==(r=n.exec(e));){const n=r[1].trim(),o=e.substring(Math.max(0,r.index-100),r.index).match(t);if(o){const e=parseInt(o[1]||o[2]||o[3]||o[4]);isNaN(e)||a.push([e,n])}}return a}replaceCode(e,n){const t=this.notebookTracker.currentWidget;if(t){const a=t.content.widgets[e-1];a&&"code"===a.model.type&&a.model.sharedModel.setSource(n)}}}var d=t(72),l=t.n(d),p=t(825),u=t.n(p),h=t(659),m=t.n(h),f=t(56),g=t.n(f),b=t(540),y=t.n(b),v=t(113),x=t.n(v),C=t(646),w={};w.styleTagTransform=x(),w.setAttributes=g(),w.insert=m().bind(null,"head"),w.domAPI=u(),w.insertStyleElement=y(),l()(C.A,w),C.A&&C.A.locals&&C.A.locals;const k={id:"trelis-jupyter-assistant:plugin",description:"A JupyterLab Code Assistant",autoStart:!0,requires:[o.INotebookTracker,i.IRenderMimeRegistry],optional:[r.ISettingRegistry,a.ILayoutRestorer],activate:(e,n,t,a,r)=>{console.log("JupyterLab extension trelis-jupyter-assistant is activated!");const o=new c(n,t);o.id="trelis-chatbot",o.title.label="Trelis",o.title.closable=!0,e.shell.add(o,"right",{rank:1e3}),r&&r.add(o,"trelis-chatbot"),a&&a.load(k.id).then((e=>{console.log("trelis-jupyter-assistant settings loaded:",e.composite)})).catch((e=>{console.error("Failed to load settings for trelis-jupyter-assistant.",e)}))}},A=k},475:(e,n,t)=>{t.d(n,{A:()=>s});var a=t(601),r=t.n(a),o=t(314),i=t.n(o)()(r());i.push([e.id,"/*\n    See the JupyterLab Developer Guide for useful CSS Patterns:\n\n    https://jupyterlab.readthedocs.io/en/stable/developer/css.html\n*/\n",""]);const s=i},646:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(601),r=t.n(a),o=t(314),i=t.n(o),s=t(475),c=i()(r());c.i(s.A),c.push([e.id,"#trelis-chatbot {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n.jp-ChatbotWidget {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n  padding: 10px;\n}\n\n.chat-interface {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.chat-container {\n  flex-grow: 1;\n  overflow-y: auto;\n  margin-bottom: 20px;\n  padding: 10px;\n}\n\n.chat-message {\n  margin-bottom: 15px;\n  padding: 10px;\n  border-radius: 8px;\n}\n\n.user-message {\n  background-color: #e6f3ff;\n}\n\n.assistant-message {\n  background-color: #f0f0f0;\n}\n\n.code-container {\n  position: relative;\n  margin: 0.5rem 0;\n  padding: 0.25rem;\n  background-color: #f8f8f8;\n  border-radius: 4px;\n}\n\n.code-container pre {\n  padding: 0.25rem;\n  margin: 0;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.replace-button {\n  position: static;\n  display: block;\n  margin-top: 0.5rem;\n  margin-right: auto;\n  background-color: #0f579b;\n  color: white;\n  border: none;\n  padding: 5px 10px;\n  cursor: pointer;\n  border-radius: 4px;\n  font-size: 12px;\n}\n\n.input-container {\n  display: flex;\n  flex-direction: column;\n  border-top: 1px solid #ccc;\n  padding-top: 10px;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.input-area {\n  width: 100%;\n  min-height: 60px;\n  margin-bottom: 10px;\n  resize: vertical;\n  padding: 8px;\n  border-radius: 4px;\n  border: 1px solid #ccc;\n  box-sizing: border-box;\n}\n\n.send-button-container {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n\n.send-button {\n  background-color: #0f579b;\n  color: white;\n  border: none;\n  padding: 8px 15px;\n  cursor: pointer;\n  border-radius: 4px;\n  margin-right: 10px;\n}\n\n.send-button-hint {\n  font-style: italic;\n  color: #666;\n}\n",""]);const d=c},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",a=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),a&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),a&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,a,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);a&&i[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),t&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=t):l[2]=t),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),n.push(l))}},n}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var n=[];function t(e){for(var t=-1,a=0;a<n.length;a++)if(n[a].identifier===e){t=a;break}return t}function a(e,a){for(var o={},i=[],s=0;s<e.length;s++){var c=e[s],d=a.base?c[0]+a.base:c[0],l=o[d]||0,p="".concat(d," ").concat(l);o[d]=l+1;var u=t(p),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)n[u].references++,n[u].updater(h);else{var m=r(h,a);a.byIndex=s,n.splice(s,0,{identifier:p,updater:m,references:1})}i.push(p)}return i}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var o=a(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var s=t(o[i]);n[s].references--}for(var c=a(e,r),d=0;d<o.length;d++){var l=t(o[d]);0===n[l].references&&(n[l].updater(),n.splice(l,1))}o=c}}},659:e=>{var n={};e.exports=function(e,t){var a=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var a="";t.supports&&(a+="@supports (".concat(t.supports,") {")),t.media&&(a+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(a+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),a+=t.css,r&&(a+="}"),t.media&&(a+="}"),t.supports&&(a+="}");var o=t.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),n.styleTagTransform(a,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}}]);